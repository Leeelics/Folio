# Claude Code æ’ä»¶æŒ‡å¯¼è¯´æ˜ä¹¦

> ä»¥ Equilibra é¡¹ç›®ä¸ºæ¡ˆä¾‹ï¼Œæ¶µç›–æ’ä»¶ç®¡ç†ã€æ ¸å¿ƒæ’ä»¶è¯¦è§£ã€å¤šç»ˆç«¯åä½œå¼€å‘å®æˆ˜ã€‚

---

## ç›®å½•

1. [æ’ä»¶ç®¡ç†åŸºç¡€](#1-æ’ä»¶ç®¡ç†åŸºç¡€)
2. [everything-claude-code æ’ä»¶è¯¦è§£](#2-everything-claude-code-æ’ä»¶è¯¦è§£)
3. [claude-mem æ’ä»¶è¯¦è§£](#3-claude-mem-æ’ä»¶è¯¦è§£)
4. [å¤šç»ˆç«¯åä½œå¼€å‘å®æˆ˜](#4-å¤šç»ˆç«¯åä½œå¼€å‘å®æˆ˜)
5. [æ¨èæ—¥å¸¸å·¥ä½œæµ](#5-æ¨èæ—¥å¸¸å·¥ä½œæµ)

---

## 1. æ’ä»¶ç®¡ç†åŸºç¡€

### 1.1 æ’ä»¶ä½“ç³»ç»“æ„

Claude Code çš„æ‰©å±•èƒ½åŠ›åˆ†ä¸ºä¸‰å±‚ï¼š

| å±‚çº§ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **Plugins** | ç¬¬ä¸‰æ–¹æ‰©å±•åŒ…ï¼Œå¯åŒ…å« agentsã€skillsã€MCP servers | `everything-claude-code`, `claude-mem` |
| **Skills** | å¯é€šè¿‡ `/plugin:skill-name` è°ƒç”¨çš„ä¸“é¡¹èƒ½åŠ› | `/everything-claude-code:tdd`, `/claude-mem:mem-search` |
| **MCP Servers** | Model Context Protocol æœåŠ¡ï¼Œæä¾›å·¥å…·çº§åˆ«çš„èƒ½åŠ› | `claude-mem` çš„ `search`ã€`save_memory` å·¥å…· |

ä¸€ä¸ªæ’ä»¶å¯ä»¥åŒæ—¶æä¾› agentsã€skills å’Œ MCP serversã€‚ä¾‹å¦‚ `everything-claude-code` æä¾› 9 ä¸ª agents å’Œ 6 ä¸ª skillsï¼Œè€Œ `claude-mem` é€šè¿‡ MCP server æä¾› 4 ä¸ªå·¥å…· + 3 ä¸ª skillsã€‚

> æ³¨æ„ï¼šæ’ä»¶çš„ skills éœ€è¦ä½¿ç”¨å®Œæ•´å‰ç¼€è°ƒç”¨ï¼Œæ ¼å¼ä¸º `/plugin-name:skill-name`ã€‚ä¾‹å¦‚ `/everything-claude-code:tdd`ï¼Œä¸èƒ½ç®€å†™ä¸º `/tdd`ã€‚

### 1.2 é…ç½®æ–‡ä»¶ä½ç½®

```
~/.claude/settings.json          # ç”¨æˆ·çº§é…ç½®ï¼ˆæ’ä»¶å¯ç”¨ã€marketplace æºï¼‰
<project>/.claude/settings.json  # é¡¹ç›®çº§é…ç½®ï¼ˆå¯è¦†ç›–ç”¨æˆ·çº§ï¼‰
<project>/CLAUDE.md              # é¡¹ç›®æŒ‡ä»¤æ–‡ä»¶ï¼ˆæ’ä»¶ä½¿ç”¨çº¦å®šç­‰ï¼‰
```

å½“å‰ Equilibra é¡¹ç›®çš„ç”¨æˆ·çº§é…ç½®ï¼š

```json
{
  "enabledPlugins": {
    "everything-claude-code@everything-claude-code": true,
    "document-skills@anthropic-agent-skills": true,
    "claude-mem@thedotmack": true
  },
  "extraKnownMarketplaces": {
    "everything-claude-code": {
      "source": {
        "source": "github",
        "repo": "affaan-m/everything-claude-code"
      }
    }
  }
}
```

### 1.3 å®‰è£…æ’ä»¶

**æ–¹å¼ä¸€ï¼šé€šè¿‡ Marketplaceï¼ˆæ¨èï¼‰**

```bash
# åœ¨ Claude Code äº¤äº’ç•Œé¢ä¸­
/install-plugin
# æŒ‰æç¤ºé€‰æ‹© marketplace å’Œæ’ä»¶å
```

å¯¹äºå®˜æ–¹ marketplace ä¸­çš„æ’ä»¶ï¼ˆå¦‚ `document-skills`ã€`claude-mem`ï¼‰ï¼Œç›´æ¥æœç´¢å®‰è£…å³å¯ã€‚

**æ–¹å¼äºŒï¼šæ·»åŠ è‡ªå®šä¹‰ Marketplace æº**

éƒ¨åˆ†æ’ä»¶ä¸åœ¨å®˜æ–¹ marketplace ä¸­ï¼ˆå¦‚ `everything-claude-code`ï¼‰ï¼Œéœ€è¦å…ˆæ·»åŠ æºï¼š

åœ¨ `~/.claude/settings.json` ä¸­æ·»åŠ ï¼š

```json
{
  "extraKnownMarketplaces": {
    "everything-claude-code": {
      "source": {
        "source": "github",
        "repo": "affaan-m/everything-claude-code"
      }
    }
  }
}
```

ç„¶ååœ¨ `enabledPlugins` ä¸­å¯ç”¨ï¼š

```json
{
  "enabledPlugins": {
    "everything-claude-code@everything-claude-code": true
  }
}
```

### 1.4 æŸ¥çœ‹å·²å®‰è£…æ’ä»¶

```bash
# åœ¨ Claude Code ä¸­æŸ¥çœ‹å½“å‰åŠ è½½çš„æ’ä»¶
/plugins
```

ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼š

```bash
cat ~/.claude/settings.json | jq '.enabledPlugins'
```

### 1.5 å‡çº§æ’ä»¶

æ’ä»¶ä» GitHub ä»“åº“æ‹‰å–ï¼Œå‡çº§æ–¹å¼ï¼š

1. æ¸…é™¤æœ¬åœ°ç¼“å­˜ï¼Œè®© Claude Code é‡æ–°æ‹‰å–æœ€æ–°ç‰ˆæœ¬
2. é‡å¯ Claude Code ä¼šè¯

```bash
# æ¸…é™¤æ’ä»¶ç¼“å­˜ï¼ˆè·¯å¾„å¯èƒ½å› ç³»ç»Ÿè€Œå¼‚ï¼‰
rm -rf ~/.claude/plugins/cache/
# é‡æ–°å¯åŠ¨ Claude Code
```

### 1.6 åˆ é™¤æ’ä»¶

åœ¨ `~/.claude/settings.json` ä¸­å°†å¯¹åº”æ’ä»¶è®¾ä¸º `false` æˆ–åˆ é™¤è¯¥è¡Œï¼š

```json
{
  "enabledPlugins": {
    "everything-claude-code@everything-claude-code": false
  }
}
```

é‡å¯ Claude Code ç”Ÿæ•ˆã€‚

---

## 2. everything-claude-code æ’ä»¶è¯¦è§£

### 2.1 æ¦‚è§ˆ

- **æ¥æº**: [github.com/affaan-m/everything-claude-code](https://github.com/affaan-m/everything-claude-code)
- **å®šä½**: Claude Code çš„"ç‘å£«å†›åˆ€"ï¼Œæä¾›ä»£ç å®¡æŸ¥ã€æ¶æ„è®¾è®¡ã€TDDã€E2E æµ‹è¯•ã€å®‰å…¨å®¡è®¡ã€æ–‡æ¡£ç”Ÿæˆç­‰å…¨æ–¹ä½å¼€å‘è¾…åŠ©
- **å®‰è£…æ–¹å¼**: è‡ªå®šä¹‰ marketplace æºï¼ˆè§ 1.3ï¼‰

### 2.2 å¯ç”¨ Agentsï¼ˆ9 ä¸ªï¼‰

Agents æ˜¯é€šè¿‡ Task å·¥å…·è‡ªåŠ¨è°ƒåº¦çš„ä¸“é¡¹å­ä»£ç†ï¼ŒClaude Code ä¼šæ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ agentï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨è°ƒç”¨ã€‚

| Agent | ç”¨é€” | è§¦å‘åœºæ™¯ |
|-------|------|----------|
| `code-reviewer` | ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§å®¡æŸ¥ | ä»£ç ä¿®æ”¹åè‡ªåŠ¨è§¦å‘ |
| `security-reviewer` | å®‰å…¨æ¼æ´æ£€æµ‹ï¼ˆOWASP Top 10ï¼‰ | æ¶‰åŠç”¨æˆ·è¾“å…¥ã€è®¤è¯ã€API æ—¶è§¦å‘ |
| `architect` | ç³»ç»Ÿè®¾è®¡ã€å¯æ‰©å±•æ€§ã€æŠ€æœ¯å†³ç­– | è§„åˆ’æ–°åŠŸèƒ½ã€é‡æ„æ—¶è§¦å‘ |
| `refactor-cleaner` | æ­»ä»£ç æ¸…ç†ã€é‡å¤ä»£ç åˆå¹¶ | é‡æ„ä»»åŠ¡æ—¶è§¦å‘ |
| `doc-updater` | æ–‡æ¡£å’Œ codemap æ›´æ–° | æ–‡æ¡£ç»´æŠ¤ä»»åŠ¡ |
| `e2e-runner` | Playwright E2E æµ‹è¯• | å‰ç«¯æµ‹è¯•ä»»åŠ¡ |
| `tdd-guide` | æµ‹è¯•é©±åŠ¨å¼€å‘å¼•å¯¼ | æ–°åŠŸèƒ½å¼€å‘ã€bug ä¿®å¤ |
| `planner` | å¤æ‚åŠŸèƒ½è§„åˆ’ | åŠŸèƒ½å®ç°ã€æ¶æ„å˜æ›´ |
| `build-error-resolver` | æ„å»ºå’Œç±»å‹é”™è¯¯ä¿®å¤ | æ„å»ºå¤±è´¥æ—¶è§¦å‘ |

> Agents å’Œ Skills çš„åŒºåˆ«ï¼šAgents ç”± Claude Code è‡ªåŠ¨è°ƒåº¦ï¼Œä½ ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ï¼›Skills éœ€è¦ä½ ä¸»åŠ¨è¾“å…¥ `/plugin:skill` æ¥è§¦å‘ã€‚

### 2.3 å¯ç”¨ Skillsï¼ˆ6 ä¸ªï¼Œç”¨æˆ·å¯è°ƒç”¨ï¼‰

Skills é€šè¿‡ `/everything-claude-code:skill-name` æ ¼å¼åœ¨å¯¹è¯ä¸­è°ƒç”¨ã€‚

| å®Œæ•´å‘½ä»¤ | ç®€ç§° | è¯´æ˜ |
|----------|------|------|
| `/everything-claude-code:tdd` | TDD | æµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œå…ˆå†™æµ‹è¯•å†å†™å®ç° |
| `/everything-claude-code:setup-pm` | Setup PM | é…ç½®é¡¹ç›®ç®¡ç†åå¥½ |
| `/everything-claude-code:test-coverage` | Test Coverage | æµ‹è¯•è¦†ç›–ç‡åˆ†æ |
| `/everything-claude-code:refactor-clean` | Refactor Clean | æ­»ä»£ç æ¸…ç†å’Œé‡æ„ |
| `/everything-claude-code:update-codemaps` | Update Codemaps | æ›´æ–°ä»£ç åœ°å›¾ |
| `/everything-claude-code:update-docs` | Update Docs | æ›´æ–°é¡¹ç›®æ–‡æ¡£ |

> æ³¨æ„ï¼šå‘½ä»¤å‰ç¼€ `everything-claude-code:` ä¸èƒ½çœç•¥ã€‚è¾“å…¥ `/` åä¼šå‡ºç°è‡ªåŠ¨è¡¥å…¨åˆ—è¡¨ã€‚

### 2.4 å¸¸è§è¯¯è§£

**"ä¸ºä»€ä¹ˆæ²¡æœ‰ `/commit`ã€`/plan`ã€`/e2e`ã€`/security-review` è¿™äº›å‘½ä»¤ï¼Ÿ"**

è¿™äº›åŠŸèƒ½ç¡®å®å­˜åœ¨ï¼Œä½†ä¸æ˜¯ä»¥ skill å½¢å¼æä¾›çš„ï¼š

| ä½ æƒ³åšçš„äº‹ | å®é™…æ–¹å¼ |
|-----------|---------|
| è§„åˆ’åŠŸèƒ½ | ç›´æ¥å‘Šè¯‰ Claude "å¸®æˆ‘è§„åˆ’..."ï¼Œ`planner` agent ä¼šè‡ªåŠ¨ä»‹å…¥ |
| ä»£ç å®¡æŸ¥ | å†™å®Œä»£ç å `code-reviewer` agent è‡ªåŠ¨è§¦å‘ |
| å®‰å…¨å®¡æŸ¥ | æ¶‰åŠæ•æ„Ÿä»£ç æ—¶ `security-reviewer` agent è‡ªåŠ¨è§¦å‘ |
| E2E æµ‹è¯• | ä½¿ç”¨ `/python-streamlit-e2e` skillï¼ˆè¿™æ˜¯ç‹¬ç«‹ skillï¼Œä¸å±äºæ­¤æ’ä»¶ï¼‰ |
| Git æäº¤ | ç›´æ¥å‘Šè¯‰ Claude "å¸®æˆ‘æäº¤"ï¼Œå®ƒä¼šç”¨å†…ç½® git èƒ½åŠ›å®Œæˆ |

ç®€å•æ¥è¯´ï¼š**å¤§éƒ¨åˆ†èƒ½åŠ›æ˜¯ agent è‡ªåŠ¨è§¦å‘çš„ï¼Œä¸éœ€è¦ä½ è®°å‘½ä»¤ã€‚**

---

## 3. claude-mem æ’ä»¶è¯¦è§£

### 3.1 æ¶æ„åŸç†

claude-mem æ˜¯ä¸€ä¸ªè·¨ä¼šè¯æŒä¹…åŒ–è®°å¿†ç³»ç»Ÿï¼Œé€šè¿‡ MCPï¼ˆModel Context Protocolï¼‰æä¾›æœåŠ¡ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Claude Code ä¼šè¯               â”‚
â”‚                                         â”‚
â”‚  save_memory() â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                    â”‚   SQLite DB   â”‚     â”‚
â”‚  search()    â”€â”€â†’   â”‚  (ç»“æ„åŒ–å­˜å‚¨)  â”‚     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  timeline()  â”€â”€â†’         â”‚              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  get_observations()â”‚  ChromaDB    â”‚     â”‚
â”‚              â”€â”€â†’   â”‚ (å‘é‡åµŒå…¥)    â”‚     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **SQLite**: å­˜å‚¨è§‚å¯Ÿè®°å½•çš„ç»“æ„åŒ–æ•°æ®ï¼ˆæ ‡é¢˜ã€å†…å®¹ã€æ—¶é—´æˆ³ã€é¡¹ç›®æ ‡ç­¾ï¼‰
- **ChromaDB**: å­˜å‚¨æ–‡æœ¬çš„å‘é‡åµŒå…¥ï¼Œæ”¯æŒè¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢

### 3.2 ä¸‰å±‚æŸ¥è¯¢åè®®

è¿™æ˜¯ claude-mem çš„æ ¸å¿ƒè®¾è®¡ï¼Œç›®çš„æ˜¯æœ€å°åŒ– token æ¶ˆè€—ï¼š

```
ç¬¬ 1 å±‚: search(query)           â†’ è¿”å›ç´¢å¼•å’Œ IDï¼ˆ~50-100 tokens/æ¡ï¼‰
ç¬¬ 2 å±‚: timeline(anchor=ID)     â†’ è·å–æŸæ¡è®°å½•å‰åçš„ä¸Šä¸‹æ–‡
ç¬¬ 3 å±‚: get_observations([IDs]) â†’ è·å–æŒ‡å®š ID çš„å®Œæ•´å†…å®¹
```

**ä¸ºä»€ä¹ˆåˆ†ä¸‰å±‚ï¼Ÿ**

ç›´æ¥è·å–æ‰€æœ‰è®°å½•çš„å®Œæ•´å†…å®¹ä¼šæ¶ˆè€—å¤§é‡ tokenã€‚ä¸‰å±‚åè®®è®©ä½ å…ˆæµè§ˆç´¢å¼•ï¼Œæ‰¾åˆ°æ„Ÿå…´è¶£çš„è®°å½•ï¼Œå†æŒ‰éœ€è·å–è¯¦æƒ…ã€‚å®˜æ–¹è¯´æ³•æ˜¯"10x token savings"ã€‚

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```
# ç¬¬ 1 å±‚ï¼šæœç´¢
search(query="budget API implementation", project="equilibra")
â†’ è¿”å›: [{id: 42, title: "Budget API endpoints added"}, ...]

# ç¬¬ 2 å±‚ï¼šæŸ¥çœ‹ä¸Šä¸‹æ–‡
timeline(anchor=42)
â†’ è¿”å›: ID 42 å‰åçš„ç›¸å…³è®°å½•æ‘˜è¦

# ç¬¬ 3 å±‚ï¼šè·å–è¯¦æƒ…
get_observations(ids=[42, 43])
â†’ è¿”å›: å®Œæ•´çš„è§‚å¯Ÿè®°å½•å†…å®¹
```

### 3.3 save_memory ç”¨æ³•

ä¿å­˜è®°å¿†ä¾›æœªæ¥ä¼šè¯æ£€ç´¢ï¼š

```
save_memory(
  text="å®Œæˆäº† Budget API çš„ CRUD ç«¯ç‚¹å®ç°ï¼ŒåŒ…æ‹¬ create/read/update/close å››ä¸ªæ“ä½œã€‚
        å…³é”®è®¾è®¡å†³ç­–ï¼šbudget close æ—¶è‡ªåŠ¨è®¡ç®— remaining = allocated - spentã€‚",
  title="Budget API CRUD å®Œæˆ",
  project="equilibra"
)
```

**å‚æ•°è¯´æ˜ï¼š**

| å‚æ•° | å¿…å¡« | è¯´æ˜ |
|------|------|------|
| `text` | æ˜¯ | è¦è®°å¿†çš„å†…å®¹ï¼Œè¶Šè¯¦ç»†è¶Šå¥½ |
| `title` | å¦ | ç®€çŸ­æ ‡é¢˜ï¼Œä¸å¡«åˆ™è‡ªåŠ¨ç”Ÿæˆ |
| `project` | å¦ | é¡¹ç›®æ ‡ç­¾ï¼Œç”¨äºè¿‡æ»¤ã€‚é»˜è®¤ `"claude-mem"` |

**æœ€ä½³å®è·µï¼š**
- æ¯æ¬¡ä¼šè¯ç»“æŸå‰ä¿å­˜å…³é”®è¿›å±•
- `text` ä¸­åŒ…å«ï¼šåšäº†ä»€ä¹ˆã€ä¸ºä»€ä¹ˆè¿™æ ·åšã€å…³é”®å†³ç­–
- å§‹ç»ˆæŒ‡å®š `project` å‚æ•°ï¼Œæ–¹ä¾¿åç»­æŒ‰é¡¹ç›®è¿‡æ»¤
- æ ‡é¢˜ç®€æ´æ˜äº†ï¼Œä¾¿äºåœ¨æœç´¢ç´¢å¼•ä¸­å¿«é€Ÿè¯†åˆ«

### 3.4 æ•°æ®å­˜å‚¨ä½ç½®

claude-mem çš„æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼š

```
~/.claude-mem/          # é»˜è®¤æ•°æ®ç›®å½•
â”œâ”€â”€ memories.db         # SQLite æ•°æ®åº“
â””â”€â”€ chroma/             # ChromaDB å‘é‡å­˜å‚¨
```

æ•°æ®å®Œå…¨æœ¬åœ°åŒ–ï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•è¿œç¨‹æœåŠ¡å™¨ã€‚

### 3.5 ä¸ `/memory` è‡ªå¸¦å‘½ä»¤çš„å¯¹æ¯”

| ç‰¹æ€§ | `/memory`ï¼ˆå†…ç½®ï¼‰ | `claude-mem`ï¼ˆæ’ä»¶ï¼‰ |
|------|-------------------|---------------------|
| å­˜å‚¨æ–¹å¼ | å†™å…¥ `CLAUDE.md` æ–‡ä»¶ | SQLite + ChromaDB |
| æœç´¢èƒ½åŠ› | æ— ï¼ˆå…¨æ–‡è¯»å–ï¼‰ | è¯­ä¹‰æœç´¢ + æ—¶é—´çº¿æµè§ˆ |
| è·¨ä¼šè¯ | âœ… é€šè¿‡æ–‡ä»¶æŒä¹…åŒ– | âœ… é€šè¿‡æ•°æ®åº“æŒä¹…åŒ– |
| è·¨é¡¹ç›® | âŒ ç»‘å®šé¡¹ç›®ç›®å½• | âœ… é€šè¿‡ `project` å‚æ•°åŒºåˆ† |
| Token æ•ˆç‡ | æ¯æ¬¡åŠ è½½å…¨éƒ¨å†…å®¹ | ä¸‰å±‚åè®®æŒ‰éœ€åŠ è½½ |
| é€‚ç”¨åœºæ™¯ | é¡¹ç›®çº§å›ºå®šæŒ‡ä»¤å’Œçº¦å®š | åŠ¨æ€å¼€å‘è¿›å±•ã€å†³ç­–è®°å½•ã€è°ƒè¯•ç»éªŒ |

**æ¨èç”¨æ³•ï¼š**
- `CLAUDE.md` / `/memory`ï¼šå­˜æ”¾ä¸å¸¸å˜åŒ–çš„é¡¹ç›®çº¦å®šï¼ˆæŠ€æœ¯æ ˆã€ç›®å½•ç»“æ„ã€å¼€å‘è§„èŒƒï¼‰
- `claude-mem`ï¼šå­˜æ”¾åŠ¨æ€çš„å¼€å‘è¿›å±•ï¼ˆå®Œæˆäº†ä»€ä¹ˆã€é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ã€åšäº†ä»€ä¹ˆå†³ç­–ï¼‰

ä¸¤è€…äº’è¡¥ï¼Œä¸æ˜¯æ›¿ä»£å…³ç³»ã€‚

---

## 4. å¤šç»ˆç«¯åä½œå¼€å‘å®æˆ˜

### 4.1 åœºæ™¯è®¾å®š

ä»¥ Equilibra é¡¹ç›®å¼€å‘ **Phase 3ï¼šæŠ•èµ„ç»„åˆç›ˆäºåˆ†æ** ä¸ºä¾‹ï¼Œæ¼”ç¤ºä¸‰ä¸ª Claude Code ç»ˆç«¯å¦‚ä½•åä½œã€‚

**é¡¹ç›®ç»“æ„å›é¡¾ï¼š**

```
app/                    # åç«¯ (Backend å®ä¾‹è´Ÿè´£)
â”œâ”€â”€ models/core.py      # æ ¸å¿ƒæ¨¡å‹
â”œâ”€â”€ api/core_routes.py  # API ç«¯ç‚¹
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â””â”€â”€ database.py

streamlit_app/          # å‰ç«¯ (Frontend å®ä¾‹è´Ÿè´£)
â”œâ”€â”€ api_client.py
â””â”€â”€ pages/

tests/                  # æµ‹è¯• (Testing å®ä¾‹è´Ÿè´£)
```

### 4.2 CLAUDE.md çš„ä½œç”¨

`CLAUDE.md` æ˜¯æ‰€æœ‰ç»ˆç«¯çš„å…±äº«ä¸Šä¸‹æ–‡ï¼Œæ¯ä¸ª Claude Code å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè¯»å–å®ƒã€‚

å…³é”®å†…å®¹ï¼š
- æŠ€æœ¯æ ˆå’Œé¡¹ç›®ç»“æ„ â†’ æ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€è®¤çŸ¥
- å¤šå®ä¾‹åˆ†å·¥è§„åˆ™ â†’ é˜²æ­¢ä¸åŒç»ˆç«¯ä¿®æ”¹åŒä¸€æ–‡ä»¶
- æ’ä»¶ä½¿ç”¨çº¦å®š â†’ ç»Ÿä¸€å¼€å‘æµç¨‹

### 4.3 ä¸‰ç»ˆç«¯åˆ†å·¥æ–¹æ¡ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»ˆç«¯ 1           â”‚  â”‚  ç»ˆç«¯ 2           â”‚  â”‚  ç»ˆç«¯ 3           â”‚
â”‚  Backend         â”‚  â”‚  Frontend        â”‚  â”‚  Testing         â”‚
â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚  ä¿®æ”¹èŒƒå›´:        â”‚  â”‚  ä¿®æ”¹èŒƒå›´:        â”‚  â”‚  ä¿®æ”¹èŒƒå›´:        â”‚
â”‚  app/            â”‚  â”‚  streamlit_app/  â”‚  â”‚  tests/          â”‚
â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚  æµç¨‹:           â”‚  â”‚  æµç¨‹:           â”‚  â”‚  æµç¨‹:           â”‚
â”‚  "å¸®æˆ‘è§„åˆ’..."    â”‚  â”‚  /mem-search     â”‚  â”‚  /mem-search     â”‚
â”‚  /ecc:tdd        â”‚  â”‚  å¼€å‘é¡µé¢         â”‚  â”‚  "å®¡æŸ¥ä»£ç "       â”‚
â”‚  save_memory     â”‚  â”‚  /ecc:tdd        â”‚  â”‚  "å®‰å…¨å®¡è®¡"       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ claude-mem â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  (å…±äº«è®°å¿†æ•°æ®åº“)
```

> `/ecc:tdd` æ˜¯ `/everything-claude-code:tdd` çš„ç¼©å†™ï¼Œä»…ç”¨äºå›¾ç¤ºã€‚å®é™…ä½¿ç”¨éœ€è¾“å…¥å®Œæ•´å‘½ä»¤ã€‚

### 4.4 å®Œæ•´å·¥ä½œæµæ¼”ç¤º

#### é˜¶æ®µä¸€ï¼šBackend ç»ˆç«¯ â€” å®ç° API

**å¼€åœºç™½ï¼š**

```
ä½ æ˜¯ Equilibra é¡¹ç›®çš„ Backend å¼€å‘å®ä¾‹ã€‚
åªä¿®æ”¹ app/ ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚
å½“å‰ä»»åŠ¡ï¼šå®ç° Phase 3 æŠ•èµ„ç»„åˆç›ˆäºåˆ†æ APIã€‚
è¯·å…ˆè§„åˆ’å®ç°æ–¹æ¡ˆã€‚
```

**å·¥ä½œæµç¨‹ï¼š**

```
1. å‘Šè¯‰ Claude "å¸®æˆ‘è§„åˆ’ Phase 3 ç›ˆäºåˆ†æ API"
   â†’ planner agent è‡ªåŠ¨ä»‹å…¥
   â†’ åˆ†æ models/core.py ä¸­çš„ Holding æ¨¡å‹
   â†’ è§„åˆ’æ–°å¢ API ç«¯ç‚¹ï¼šGET /api/v1/core/portfolio/pnl
   â†’ ç”¨æˆ·å®¡æ‰¹è®¡åˆ’

2. /everything-claude-code:tdd
   â†’ å…ˆå†™æµ‹è¯•ï¼štest_portfolio_pnl.py
   â†’ å†å®ç°ï¼šservices/portfolio.py + api/core_routes.py
   â†’ ç¡®ä¿æµ‹è¯•é€šè¿‡

3. ä¿å­˜è¿›å±•åˆ° claude-memï¼š
   save_memory(
     text="Phase 3 ç›ˆäºåˆ†æ API å®Œæˆã€‚
           æ–°å¢ç«¯ç‚¹: GET /api/v1/core/portfolio/pnl
           è¯·æ±‚å‚æ•°: account_id (å¯é€‰), period (7d/30d/all)
           è¿”å›: {holdings: [{symbol, qty, avg_cost, current_price, pnl, pnl_pct}], total_pnl}
           å®ç°æ–‡ä»¶: app/services/portfolio.py, app/api/core_routes.py
           æµ‹è¯•æ–‡ä»¶: tests/test_portfolio_pnl.py (8 tests passing)",
     title="Phase 3 ç›ˆäºåˆ†æ API å®Œæˆ",
     project="equilibra"
   )
```

#### é˜¶æ®µäºŒï¼šFrontend ç»ˆç«¯ â€” å¼€å‘é¡µé¢

**å¼€åœºç™½ï¼š**

```
ä½ æ˜¯ Equilibra é¡¹ç›®çš„ Frontend å¼€å‘å®ä¾‹ã€‚
åªä¿®æ”¹ streamlit_app/ ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚
å½“å‰ä»»åŠ¡ï¼šä¸º Phase 3 ç›ˆäºåˆ†æåŠŸèƒ½å¼€å‘å‰ç«¯é¡µé¢ã€‚
è¯·å…ˆç”¨ /claude-mem:mem-search æœç´¢åç«¯ API çš„æœ€æ–°è¿›å±•ã€‚
```

**å·¥ä½œæµç¨‹ï¼š**

```
1. æœç´¢åç«¯è¿›å±•ï¼š
   /claude-mem:mem-search
   â†’ æœç´¢ "Phase 3 ç›ˆäºåˆ†æ API"
   â†’ äº†è§£ API ç«¯ç‚¹ã€å‚æ•°ã€è¿”å›æ ¼å¼

2. å¼€å‘é¡µé¢ï¼š
   â†’ åœ¨ api_client.py ä¸­æ·»åŠ  get_portfolio_pnl() æ–¹æ³•
   â†’ åˆ›å»º streamlit_app/pages/5_ğŸ“Š_æŠ•èµ„ç»„åˆ.py
   â†’ è°ƒç”¨ API å±•ç¤ºç›ˆäºæ•°æ®

3. /python-streamlit-e2e
   â†’ ç”Ÿæˆç«¯åˆ°ç«¯æµ‹è¯•
   â†’ éªŒè¯é¡µé¢åŠŸèƒ½æ­£å¸¸

4. ä¿å­˜è¿›å±•ï¼š
   save_memory(
     text="Phase 3 å‰ç«¯é¡µé¢å®Œæˆã€‚
           æ–°å¢é¡µé¢: pages/5_ğŸ“Š_æŠ•èµ„ç»„åˆ.py
           åŠŸèƒ½: æŒä»“ç›ˆäºè¡¨æ ¼ã€æ€»ç›ˆäºæ±‡æ€»ã€ç­›é€‰æ¡ä»¶
           api_client æ–°å¢: get_portfolio_pnl(account_id, period)
           E2E æµ‹è¯•: 3 ä¸ªæµ‹è¯•ç”¨ä¾‹é€šè¿‡",
     title="Phase 3 å‰ç«¯é¡µé¢å®Œæˆ",
     project="equilibra"
   )
```

#### é˜¶æ®µä¸‰ï¼šTesting ç»ˆç«¯ â€” å®¡æŸ¥ä¸å®‰å…¨

**å¼€åœºç™½ï¼š**

```
ä½ æ˜¯ Equilibra é¡¹ç›®çš„ Testing å¼€å‘å®ä¾‹ã€‚
åªä¿®æ”¹ tests/ ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚
å½“å‰ä»»åŠ¡ï¼šå¯¹ Phase 3 ç›ˆäºåˆ†æåŠŸèƒ½è¿›è¡Œä»£ç å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚
è¯·å…ˆç”¨ /claude-mem:mem-search æœç´¢å·²å®Œæˆçš„å·¥ä½œã€‚
```

**å·¥ä½œæµç¨‹ï¼š**

```
1. æœç´¢å…¨éƒ¨è¿›å±•ï¼š
   /claude-mem:mem-search
   â†’ æœç´¢ "Phase 3"
   â†’ è·å– Backend å’Œ Frontend çš„å®Œæˆæƒ…å†µ

2. å‘Šè¯‰ Claude "å®¡æŸ¥ portfolio.py çš„ä»£ç è´¨é‡"
   â†’ code-reviewer agent è‡ªåŠ¨ä»‹å…¥
   â†’ å®¡æŸ¥ app/services/portfolio.py
   â†’ å®¡æŸ¥ streamlit_app/pages/5_ğŸ“Š_æŠ•èµ„ç»„åˆ.py

3. å‘Šè¯‰ Claude "å¯¹ç›ˆäºåˆ†æåŠŸèƒ½åšå®‰å…¨å®¡è®¡"
   â†’ security-reviewer agent è‡ªåŠ¨ä»‹å…¥
   â†’ æ£€æŸ¥ API ç«¯ç‚¹çš„è¾“å…¥éªŒè¯
   â†’ æ£€æŸ¥ SQL æ³¨å…¥é£é™©
   â†’ æ£€æŸ¥æ•°æ®æ³„éœ²é£é™©

4. è¡¥å……æµ‹è¯•ï¼š
   â†’ æ·»åŠ è¾¹ç•Œæ¡ä»¶æµ‹è¯•
   â†’ æ·»åŠ å¼‚å¸¸åœºæ™¯æµ‹è¯•

5. ä¿å­˜å®¡æŸ¥ç»“æœï¼š
   save_memory(
     text="Phase 3 ä»£ç å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡å®Œæˆã€‚
           å‘ç°é—®é¢˜: æ— ä¸¥é‡å®‰å…¨æ¼æ´
           å»ºè®®: portfolio.py ä¸­çš„ä»·æ ¼è®¡ç®—å»ºè®®æ·»åŠ  Decimal ç²¾åº¦å¤„ç†
           è¡¥å……æµ‹è¯•: 3 ä¸ªè¾¹ç•Œæ¡ä»¶æµ‹è¯•å·²æ·»åŠ ",
     title="Phase 3 å®¡æŸ¥å®Œæˆ",
     project="equilibra"
   )
```

### 4.5 é¿å…å†²çªçš„è§„åˆ™

1. **æ–‡ä»¶æ‰€æœ‰æƒæ˜ç¡®**ï¼šæ¯ä¸ªç»ˆç«¯åªä¿®æ”¹è‡ªå·±è´Ÿè´£çš„ç›®å½•
2. **å…±äº«æ¨¡å‹ç‹¬å **ï¼š`app/models/core.py` åªç”± Backend å®ä¾‹ä¿®æ”¹
3. **é€šè¿‡ claude-mem é€šä¿¡**ï¼šä¸è¦ç›´æ¥ä¿®æ”¹å…¶ä»–ç»ˆç«¯çš„æ–‡ä»¶ï¼Œé€šè¿‡è®°å¿†ä¼ é€’ä¿¡æ¯
4. **å…ˆæœç´¢å†å¼€å‘**ï¼šå¼€å§‹å·¥ä½œå‰å…ˆ `search()` æŸ¥çœ‹å…¶ä»–ç»ˆç«¯çš„æœ€æ–°è¿›å±•
5. **åŠæ—¶ä¿å­˜è¿›å±•**ï¼šæ¯ä¸ªé˜¶æ®µå®Œæˆåç«‹å³ `save_memory()`
6. **CLAUDE.md ä¿æŒç¨³å®š**ï¼šè¿è¡Œæ—¶ä¸è¦é¢‘ç¹ä¿®æ”¹ `CLAUDE.md`ï¼Œå®ƒæ˜¯å…±äº«çš„é™æ€ä¸Šä¸‹æ–‡

---

## 5. æ¨èæ—¥å¸¸å·¥ä½œæµ

### 5.1 å®Œæ•´å¼€å‘æµç¨‹

```
å¼€å§‹ä¼šè¯
  â”‚
  â”œâ”€â†’ æœç´¢è®°å¿†: /claude-mem:mem-search
  â”‚   äº†è§£é¡¹ç›®å½“å‰çŠ¶æ€
  â”‚
  â”œâ”€â†’ è§„åˆ’: å‘Šè¯‰ Claude "å¸®æˆ‘è§„åˆ’..."
  â”‚   planner agent è‡ªåŠ¨ä»‹å…¥ï¼Œæ˜ç¡®å®ç°æ–¹æ¡ˆ
  â”‚
  â”œâ”€â†’ ç¼–ç : /everything-claude-code:tdd
  â”‚   å…ˆå†™æµ‹è¯•ï¼Œå†å†™å®ç°
  â”‚
  â”œâ”€â†’ å®¡æŸ¥: code-reviewer agent è‡ªåŠ¨è§¦å‘
  â”‚   å†™å®Œä»£ç åè‡ªåŠ¨æ£€æŸ¥è´¨é‡
  â”‚
  â”œâ”€â†’ å®‰å…¨: security-reviewer agent è‡ªåŠ¨è§¦å‘
  â”‚   æ¶‰åŠæ•æ„Ÿä»£ç æ—¶è‡ªåŠ¨æ£€æŸ¥
  â”‚
  â”œâ”€â†’ æµ‹è¯•: /python-streamlit-e2e (å¦‚æ¶‰åŠå‰ç«¯)
  â”‚   ç«¯åˆ°ç«¯éªŒè¯
  â”‚
  â”œâ”€â†’ æäº¤: å‘Šè¯‰ Claude "å¸®æˆ‘æäº¤"
  â”‚   ä½¿ç”¨å†…ç½® git èƒ½åŠ›å®Œæˆ
  â”‚
  â””â”€â†’ ä¿å­˜è¿›å±•: save_memory(text="...", project="equilibra")
      è®°å½•æœ¬æ¬¡ä¼šè¯çš„å…³é”®æˆæœ
```

### 5.2 æ’ä»¶å‘½ä»¤é€ŸæŸ¥è¡¨

**ç”¨æˆ·ä¸»åŠ¨è°ƒç”¨çš„ Skillsï¼š**

| å‘½ä»¤ | æ¥æº | ç”¨é€” | ä½¿ç”¨æ—¶æœº |
|------|------|------|----------|
| `/everything-claude-code:tdd` | everything-claude-code | æµ‹è¯•é©±åŠ¨å¼€å‘ | ç¼–ç é˜¶æ®µ |
| `/everything-claude-code:test-coverage` | everything-claude-code | æµ‹è¯•è¦†ç›–ç‡åˆ†æ | æµ‹è¯•å®Œæˆå |
| `/everything-claude-code:refactor-clean` | everything-claude-code | æ­»ä»£ç æ¸…ç† | é‡æ„æ—¶ |
| `/everything-claude-code:update-codemaps` | everything-claude-code | æ›´æ–°ä»£ç åœ°å›¾ | ç»“æ„å˜æ›´å |
| `/everything-claude-code:update-docs` | everything-claude-code | æ›´æ–°æ–‡æ¡£ | åŠŸèƒ½å®Œæˆå |
| `/everything-claude-code:setup-pm` | everything-claude-code | é…ç½®é¡¹ç›®ç®¡ç† | é¦–æ¬¡ä½¿ç”¨æ—¶ |
| `/claude-mem:mem-search` | claude-mem | æœç´¢è·¨ä¼šè¯è®°å¿† | ä¼šè¯å¼€å§‹æ—¶ |
| `/claude-mem:make-plan` | claude-mem | å¸¦è®°å¿†çš„è§„åˆ’ | å¤æ‚åŠŸèƒ½è§„åˆ’ |
| `/claude-mem:do` | claude-mem | æ‰§è¡Œè®¡åˆ’ | è®¡åˆ’å®¡æ‰¹å |
| `/python-streamlit-e2e` | ç‹¬ç«‹ skill | Streamlit E2E æµ‹è¯• | å‰ç«¯å®Œæˆå |

**è‡ªåŠ¨è§¦å‘çš„ Agentsï¼ˆæ— éœ€æ‰‹åŠ¨è°ƒç”¨ï¼‰ï¼š**

| Agent | æ¥æº | è§¦å‘æ¡ä»¶ |
|-------|------|----------|
| `code-reviewer` | everything-claude-code | ä»£ç ä¿®æ”¹å |
| `security-reviewer` | everything-claude-code | æ¶‰åŠæ•æ„Ÿä»£ç æ—¶ |
| `architect` | everything-claude-code | æ¶æ„å†³ç­–æ—¶ |
| `planner` | everything-claude-code | åŠŸèƒ½è§„åˆ’æ—¶ |
| `build-error-resolver` | everything-claude-code | æ„å»ºå¤±è´¥æ—¶ |

**MCP å·¥å…·ï¼ˆClaude è‡ªåŠ¨ä½¿ç”¨ï¼Œä¹Ÿå¯åœ¨å¯¹è¯ä¸­æåŠï¼‰ï¼š**

| å·¥å…· | æ¥æº | ç”¨é€” |
|------|------|------|
| `save_memory()` | claude-mem | ä¿å­˜è®°å¿† |
| `search()` | claude-mem | æœç´¢è®°å¿† |
| `timeline()` | claude-mem | æŸ¥çœ‹æ—¶é—´çº¿ä¸Šä¸‹æ–‡ |
| `get_observations()` | claude-mem | è·å–è®°å½•è¯¦æƒ… |

### 5.3 Equilibra é¡¹ç›®ä¸“ç”¨çº¦å®š

æ¥è‡ªé¡¹ç›® `CLAUDE.md` çš„æ ‡å‡†æµç¨‹ï¼š

```
æ–°åŠŸèƒ½å¼€å§‹å‰  â†’ å‘Šè¯‰ Claude "å¸®æˆ‘è§„åˆ’..."ï¼ˆplanner agent è‡ªåŠ¨ä»‹å…¥ï¼‰
åç«¯å¼€å‘      â†’ /everything-claude-code:tdd â†’ code-reviewer è‡ªåŠ¨å®¡æŸ¥
å‰ç«¯å®Œæˆå    â†’ /python-streamlit-e2e
æäº¤å‰        â†’ security-reviewer è‡ªåŠ¨å®¡æŸ¥ï¼ˆæˆ–ä¸»åŠ¨è¦æ±‚ "åšå®‰å…¨å®¡è®¡"ï¼‰
ä¼šè¯ç»“æŸ      â†’ save_memory(project="equilibra")
```

---

*æœ¬æ–‡æ¡£åŸºäº Claude Code åŠå…¶æ’ä»¶ç”Ÿæ€ç¼–å†™ï¼Œæ’ä»¶ç‰ˆæœ¬å’ŒåŠŸèƒ½å¯èƒ½éšæ›´æ–°å˜åŒ–ã€‚*
